"use strict";
var expect = require('expect.js');
var msgpack = require('../index');


describe('msgpack', function() {

  describe('#decodeFromB64',function(){
    it('should return an array', function() {
      var result = msgpack.decodeFromB64('lADOAAcFsc0E2s0E1w');
      expect(result).to.be.an('array');
      expect(result).to.eql([0, 460209, 1242, 1239]);
    });

    it('should return an object',function(){
      var result = msgpack.decodeFromB64('hAEBAoEBv+eCuemlreeCuemlrSDku4rlpKnmgLvnrpfmsqHlv5gDwATA');
      expect(result).to.be.an('object');
      expect(result).to.eql({"1":1,"2":{"1":"点饭点饭 今天总算没忘"},"3":null,"4":null});
    })

    it('should decode emoji correctly',function(){
      var result = msgpack.decodeFromB64('hAEBAoEB2gJc8J+YhPCfmIPwn5iA8J+YiuKYuu+4j/CfmInwn5iN8J+YmPCfmJrwn5iX8J+YmfCfmJzwn5id8J+Ym/CfmLPwn5iB8J+YlPCfmIzwn5iS8J+YnvCfmKPimIDvuI/im4XvuI/imIHvuI/imqHvuI/imJTvuI/inYTvuI/im4TvuI/wn4yK8J+MgPCfjIjwn4yB8J+MnvCfjJ3wn4ya8J+MkfCfjJLwn4yT8J+MlPCfjJXwn4yY8J+Ml/CfjI3wn4yM4q2Q77iP8J+MjfCfjYHwn5KQ8J+NgvCfjLjwn4y68J+MkPCfjLTwn5CC8J+Qk/CfkILwn5CA8J+QhvCfkIbwn5C+8J+QjPCfkJTwn5Cm8J+QjfCfkKbwn5CL8J+QnPCfkJzwn5Cc8J+QjPCfkLfwn5Cv8J+QufCfkLbwn5CX8J+NiPCfjZLwn42L8J+Nr/Cfja3wn42P8J+NrPCfjYjwn42N8J+HuvCfh7jwn4ew8J+Ht/CfjrDwn46w8J+OqvCfh67wn4e58J+HrPCfh6fwn4aR8J+at/CfhpjinYfvuI/wn5qz8J+Ts+KchfCfhprinY7wn5O04pmN77iP4pmI77iP4pm777iP8J+FsOKdleKdjOKEovCfkrnigYnvuI/CqeKEovCflZPwn5Wi8J+Vp/CflZ3wn5WW8J+Sr/CflJjinpbwn5Wk4pyU77iP8J+UseKYke+4j+KesOKaqu+4j/CflLXilqvvuI/il7zvuI/wn5Sz8J+UufCfk7bwn5SC8J+UgPCfiK/vuI/wn4izOeKDozDig6M14oOjIAPABMA=');
      expect(result).to.be.an('object');
      expect(result[2][1].charCodeAt(0)).to.be(55357);
      expect(result[2][1].charCodeAt(1)).to.be(56836);
    })

    it('should decode Russia charactor correctly', function(){
      var result = msgpack.decodeFromB64('gwGIAc798L90AqkxMjkxMDE4NjgDggHOAASkrgIXBAEFAQbPAAABVChUZ1oHggEBAoEBotGOCAACgQEAA4IBAwIE');
      expect(result).to.be.an('object');
      expect(result[1][7][2][1].charCodeAt(0)).to.be(1102);
    })

    // it('test decode', function(){
    //     // var result = msgpack.decodeFromB64('ggGpMjEwNTAxOTYzBN4AEAGpMjEwNTAxOTYzAggD2gAp6ZKJ6ZKJLeS4gOmAlCzkuIDpgJTlsI/lj7cyLOS4gOmAlOa1i+ivlTME2gCiJDpbeyJ1SWQiOiI1OTk4NTczOCIsIm1lZGlhSWQiOiJAbEFET0M2ZDYtTTBDNU0wQzVBIiwibmljayI6IumSiemSiS3kuIDpgJQifSx7InVJZCI6Ijk1ODI5Mzg2IiwibmljayI6IuS4gOmAlOWwj+WPtzIifSx7InVJZCI6IjEyNDM2MTExNCIsIm5pY2siOiLkuIDpgJTmtYvor5UzIn1dBcIGAAeBrW5ld0NTcGFjZUlkSU2pMjI5MzA2ODM3CMIJwgoACwAMAA3OA5NPSg6BAQEPABCCAQECggGzQGxBTE9iNV9hX00wQ1dNMENXQQLTiFiydHDlX3E=');
    //     var result = msgpack.decodeFromB64('gqExh6ExzKGhMq4yMTA3ODo2MjI5Mzc0M6EzgqExzVJWoTIMoTQBoTUBoTbLQnWAGg7p8AChN4KhMQGhMoGhMdkyMTIzNDU2Nzg5MDEyMzQ1Njc4OTAxMjM0NTY3ODkweHh4eHh4eHh4eHl5eXl5eXl5eXmhMoGhMQE=')
    //     console.log(result);
    // })

  })

});
